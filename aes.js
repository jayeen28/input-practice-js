"use strict";var keySizeInBits=256,blockSizeInBits=128,roundsArray=[,,,,[,,,,10,,12,,14],,[,,,,12,,12,,14],,[,,,,14,,14,,14]],shiftOffsets=[,,,,[,1,2,3],,[,1,2,3],,[,1,3,4]],Rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],SBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],SBoxInverse=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];function cyclicShiftLeft(n,r){var t=n.slice(0,r);return n=n.slice(r).concat(t)}var Nk=keySizeInBits/32,Nb=blockSizeInBits/32,Nr=roundsArray[Nk][Nb];function xtime(n){return 256&(n<<=1)?283^n:n}function mult_GF256(n,r){var t,e=0;for(t=1;t<256;t*=2,r=xtime(r))n&t&&(e^=r);return e}function byteSub(n,r){var t;t="encrypt"==r?SBox:SBoxInverse;for(var e=0;e<4;e++)for(var o=0;o<Nb;o++)n[e][o]=t[n[e][o]]}function shiftRow(n,r){for(var t=1;t<4;t++)n[t]=cyclicShiftLeft(n[t],"encrypt"==r?shiftOffsets[Nb][t]:Nb-shiftOffsets[Nb][t])}function mixColumn(n,r){for(var t=[],e=0;e<Nb;e++){for(var o=0;o<4;o++)t[o]="encrypt"==r?mult_GF256(n[o][e],2)^mult_GF256(n[(o+1)%4][e],3)^n[(o+2)%4][e]^n[(o+3)%4][e]:mult_GF256(n[o][e],14)^mult_GF256(n[(o+1)%4][e],11)^mult_GF256(n[(o+2)%4][e],13)^mult_GF256(n[(o+3)%4][e],9);for(o=0;o<4;o++)n[o][e]=t[o]}}function addRoundKey(n,r){for(var t=0;t<Nb;t++)n[0][t]^=255&r[t],n[1][t]^=r[t]>>8&255,n[2][t]^=r[t]>>16&255,n[3][t]^=r[t]>>24&255}function keyExpansion(n){var r,t=new Array;Nb=blockSizeInBits/32,Nr=roundsArray[Nk=keySizeInBits/32][Nb];for(var e=0;e<Nk;e++)t[e]=n[4*e]|n[4*e+1]<<8|n[4*e+2]<<16|n[4*e+3]<<24;for(e=Nk;e<Nb*(Nr+1);e++)r=t[e-1],e%Nk==0?r=(SBox[r>>8&255]|SBox[r>>16&255]<<8|SBox[r>>24&255]<<16|SBox[255&r]<<24)^Rcon[Math.floor(e/Nk)-1]:Nk>6&&e%Nk==4&&(r=SBox[r>>24&255]<<24|SBox[r>>16&255]<<16|SBox[r>>8&255]<<8|SBox[255&r]),t[e]=t[e-Nk]^r;return t}function Round(n,r){byteSub(n,"encrypt"),shiftRow(n,"encrypt"),mixColumn(n,"encrypt"),addRoundKey(n,r)}function InverseRound(n,r){addRoundKey(n,r),mixColumn(n,"decrypt"),shiftRow(n,"decrypt"),byteSub(n,"decrypt")}function FinalRound(n,r){byteSub(n,"encrypt"),shiftRow(n,"encrypt"),addRoundKey(n,r)}function InverseFinalRound(n,r){addRoundKey(n,r),shiftRow(n,"decrypt"),byteSub(n,"decrypt")}function encrypt(n,r){var t;if(n&&8*n.length==blockSizeInBits&&r){for(addRoundKey(n=packBytes(n),r),t=1;t<Nr;t++)Round(n,r.slice(Nb*t,Nb*(t+1)));return FinalRound(n,r.slice(Nb*Nr)),unpackBytes(n)}}function decrypt(n,r){var t;if(n&&8*n.length==blockSizeInBits&&r){for(InverseFinalRound(n=packBytes(n),r.slice(Nb*Nr)),t=Nr-1;t>0;t--)InverseRound(n,r.slice(Nb*t,Nb*(t+1)));return addRoundKey(n,r),unpackBytes(n)}}function byteArrayToHex(n){var r="";if(n){for(var t=0;t<n.length;t++)r+=(n[t]<16?"0":"")+n[t].toString(16);return r}}function hexToByteArray(n){var r=[];n.length%2&&(0!=n.indexOf("0x")&&0!=n.indexOf("0X")||(n=n.substring(2)));for(var t=0;t<n.length;t+=2)r[Math.floor(t/2)]=parseInt(n.slice(t,t+2),16);return r}function packBytes(n){var r=new Array;if(n&&!(n.length%4)){r[0]=new Array,r[1]=new Array,r[2]=new Array,r[3]=new Array;for(var t=0;t<n.length;t+=4)r[0][t/4]=n[t],r[1][t/4]=n[t+1],r[2][t/4]=n[t+2],r[3][t/4]=n[t+3];return r}}function unpackBytes(n){for(var r=new Array,t=0;t<n[0].length;t++)r[r.length]=n[0][t],r[r.length]=n[1][t],r[r.length]=n[2][t],r[r.length]=n[3][t];return r}function formatPlaintext(n){var r,t=blockSizeInBits/8;if(("object"!=typeof n||"number"!=typeof n[0])&&("string"==typeof n||n.indexOf))for(n=n.split(""),r=0;r<n.length;r++)n[r]=255&n[r].charCodeAt(0);return(r=n.length%t)>0&&(n=n.concat(getRandomBytes(t-r))),n}function getRandomBytes(n){var r,t=new Array;for(r=0;r<n;r++)t[r]=prng.nextInt(255);return t}function rijndaelEncrypt(n,r,t){var e,o,i,c=blockSizeInBits/8;if(n&&r&&8*r.length==keySizeInBits){"CBC"==t?i=getRandomBytes(c):(t="ECB",i=new Array),n=formatPlaintext(n),e=keyExpansion(r);for(var a=0;a<n.length/c;a++){if(o=n.slice(a*c,(a+1)*c),"CBC"==t)for(var f=0;f<c;f++)o[f]^=i[a*c+f];i=i.concat(encrypt(o,e))}return i}}function rijndaelDecrypt(n,r,t){var e,o,i,c=blockSizeInBits/8,a=new Array;if(n&&r&&"string"!=typeof n&&8*r.length==keySizeInBits){for(t||(t="ECB"),e=keyExpansion(r),i=n.length/c-1;i>0;i--)if(o=decrypt(n.slice(i*c,(i+1)*c),e),"CBC"==t)for(var f=0;f<c;f++)a[(i-1)*c+f]=o[f]^n[(i-1)*c+f];else a=o.concat(a);return"ECB"==t&&(a=decrypt(n.slice(0,c),e).concat(a)),a}}