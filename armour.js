"use strict";var acgcl,acgt,acgg,maxLineLength=64,hexSentinel="?HX?",hexEndSentinel="?H";function armour_hex(e){for(var n=hexSentinel+byteArrayToHex(e)+hexEndSentinel,r="";n.length>maxLineLength;)r+=n.substring(0,maxLineLength)+"\n",n=n.substring(maxLineLength,n.length);return r+=n+"\n"}function disarm_hex(e){var n,r="";for((n=e.indexOf(hexSentinel))>=0&&(e=e.substring(n+hexSentinel.length,e.length)),(n=e.indexOf(hexEndSentinel))>=0&&(e=e.substring(0,n)),n=0;n<e.length;n++){var t=e.charAt(n);"0123456789abcdefABCDEF".indexOf(t)>=0&&(r+=t)}return hexToByteArray(r)}function armour_cg_outgroup(){acgcl.length>maxLineLength&&(acgt+=acgcl+"\n",acgcl=""),acgcl.length>0&&(acgcl+=" "),acgcl+=acgg,acgg=""}function armour_cg_outletter(e){acgg.length>=5&&armour_cg_outgroup(),acgg+=e}var dcgs,dcgi,codegroupSentinel="ZZZZZ";function armour_codegroup(e){var n="A".charCodeAt(0);acgcl=codegroupSentinel,acgt="",acgg="";for(var r=new LEcuyer(195948557),t=0;t<e.length;t++){var a=r.nextInt(23);armour_cg_outletter(String.fromCharCode(n+((e[t]>>4&15)+a)%24)),a=r.nextInt(23),armour_cg_outletter(String.fromCharCode(n+((15&e[t])+a)%24))}for(r=null;acgg.length<5;)armour_cg_outletter("Z");return armour_cg_outgroup(),acgg="YYYYY",armour_cg_outgroup(),acgt+=acgcl+"\n"}function disarm_cg_insig(){for(;dcgi<dcgs.length;){var e=dcgs.charAt(dcgi++).toUpperCase();if(e>="A"&&e<="Z")return e}return""}function disarm_codegroup(e){var n,r,t=new Array,a=0,g=0;for(dcgs=e,dcgi=0;a<5;)if("Z"==(r=disarm_cg_insig()))a++;else{if(""==r){a=0;break}a=0}if(0==a)return alert("No codegroup starting symbol found in message."),"";var c="A".charCodeAt(0),o=new LEcuyer(195948557);for(a=0;a<2&&("Y"!=(r=disarm_cg_insig())&&""!=r);)if("Z"!=r){var i=o.nextInt(23),s=r.charCodeAt(0)-c;s=(s+(24-i))%24,0==a?(n=s<<4,a++):(n|=s,t[g++]=n,a=0)}o=null;var u="  Attempting decoding with data received.";if(0!=a)alert("Codegroup data truncated."+u);else if("Y"==r){for(a=1;a<5&&"Y"==(r=disarm_cg_insig());)a++;5!=a&&alert("Codegroup end group incomplete."+u)}else alert("Codegroup end group missing."+u);return t}var base64code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64sent="?b64",base64esent="?64b",base64addsent=!0;function armour_base64(e){var n,r="",t=base64addsent?base64sent:"";for(n=0;n<=e.length-3;n+=3)t.length+4>maxLineLength&&(r+=t+"\n",t=""),t+=base64code.charAt(e[n]>>2),t+=base64code.charAt((3&e[n])<<4|e[n+1]>>4),t+=base64code.charAt((15&e[n+1])<<2|e[n+2]>>6),t+=base64code.charAt(63&e[n+2]);return e.length-n==1?(t+=base64code.charAt(e[n]>>2),t+=base64code.charAt((3&e[n])<<4),t+="=="):e.length-n==2&&(t+=base64code.charAt(e[n]>>2),t+=base64code.charAt((3&e[n])<<4|e[n+1]>>4),t+=base64code.charAt((15&e[n+1])<<2),t+="="),t.length+4>maxLineLength&&(r+=t+"\n",t=""),base64addsent&&(t+=base64esent),r+=t+"\n"}function disarm_base64(e){var n,r,t=new Array,a=0,g=0,c=0,o=new Array;for((n=e.indexOf(base64sent))>=0&&(e=e.substring(n+base64sent.length,e.length)),(n=e.indexOf(base64esent))>=0&&(e=e.substring(0,n));a<e.length&&-1==base64code.indexOf(e.charAt(a));)a++;for(;a<e.length;){for(n=0;n<4;){if(a>=e.length){if(n>0)return alert("Base64 cipher text truncated."),t;break}if((r=base64code.indexOf(e.charAt(a)))>=0)o[n++]=r;else if("="==e.charAt(a))o[n++]=0,g++;else if(e.substring(a,a+base64esent.length)==base64esent){a=e.length;continue}a++}4==n&&(t[c++]=255&(o[0]<<2|o[1]>>4),g<2&&(t[c++]=255&(o[1]<<4|o[2]>>2),g<1&&(t[c++]=255&(o[2]<<6|o[3]))))}return t}